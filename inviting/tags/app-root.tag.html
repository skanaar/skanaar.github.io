<app-root>
  <div class="page">
    <nav>
      <h3>Inviting!</h3>
      <a each={e in myEvents} class=capsule href="#event/{e}">{e}</a>
      <a class=action href="#create">Create</a>
    </nav>
    
    <event-editor if={pageIs('create')} app={app}></event-editor>
    <event-view if={pageIs('event')} app={app} id={event_id}></event-view>
  </div>

  <style>
    .page {
      max-width: 750px;
      margin: 0 auto;
    }
    nav { margin: 0 0 50px 0; }
    nav h3 { display: inline-block; }
    nav a {
      background: var(--box-background);
      border: var(--box-border);
      padding: 5px 15px;
      margin: 0 0 10px 0;
    }
  </style>
  <script>
    var app = App()

    var self = this

    self.app = app
    self.event_id = null

    self.pageIs = (key) => app.page == key

    window.addEventListener('hashchange', function (){
      var parts = window.location.hash.substr(1).split('/')
      app.route(parts[0], parts[1])
    })

    self.app.signals.on('reroute', function (page, id) {
      self.event_id = id
      self.update()
    })

    self.app.api.myEvents(null, events => self.myEvents = events)

    this.on('mount', function(){
      self.onhashchange()
    })

  </script>
</app-root>

<filter-tools>
  <span class="btn-group" style="margin-bottom: 5px">
    <a class={'toggle-btn': true, active: type==e}
       each={e in opts.types}
       onclick={() => setType(e)}>{e.substr(0,4)}</a>
  </span>
  <input type=text placeholder="filter..." value={query} oninput={onQueryChange}>
  <script>
    var self = this
    self.type = self.opts.type || null
    self.query = self.opts.query || ''
    var onchange = self.opts.onfilter || function (){}
    self.setType = function (type) {
      self.type = self.type == type ? null : type
      onchange(self)
    }
    self.onQueryChange = function (e) {
      self.query = e.target.value || ''
      onchange(self)
    }
    self.predicate = function (e) {
      return (!self.type || (self.type == e.type || self.type == e.tags)) && 
        (!self.query || e.name.toLowerCase().includes(self.query) || e.level == +self.query)
    }
  </script>
</filter-tools>
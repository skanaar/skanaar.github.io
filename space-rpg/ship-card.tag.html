<ship-card>

  <div class="card">
    <h2>{ship().name}</h2>
    <div class="card-row">
      <div>Attributes</div>
      <b>{ship().attr.maxhull}</b>
      <b>{ship().attr.maxshield}</b>
      <b>{ship().attr.maxenergy}</b>
    </div>
    <div class="card-row">
      <div>Generated per turn</div>
      <b>{generated().hull}</b>
      <b>{generated().shield}</b>
      <b>{generated().energy}</b>
    </div>
  </div>

  <script>
    var self = this
    var app = self.opts.app

    self.ship = () => self.opts.ship || { name: '', attr: {}, generators: {} }
    self.generated = function () {
      if (!self.opts.ship) { return {} }
      var items = (self.opts.ship.inventory || [])
        .map(e => _.findWhere(app.world.items, { name: e }))
        .filter(e => e.type == 'module')
      return {
        hull: self.opts.ship.generator.hull + _.sum(items, item => item.playerBuff.hull),
        shield: self.opts.ship.generator.shield + _.sum(items, item => item.playerBuff.shield),
        energy: self.opts.ship.generator.energy + _.sum(items, item => item.playerBuff.energy)
      }
    }
  </script>

</ship-card>
